#+STARTUP: hideblocks
#+PROPERTY: header-args :results output

* SHA-256
** Plain text input
#+HEADER: :var TEXT = "abcd"
#+begin_src janet
  (use botan)
  (print (hex-encode (:final (:update (hash/new "SHA-256") TEXT))))
#+end_src

#+RESULTS:
: 88D4266FD4E6338D13B845FCF289579D209C897823B9217DA3E161936F031589

** Hex input
#+HEADER: :var INPUT = "01020304"
#+begin_src janet
  (use botan)
  (print (hex-encode (:final (:update (hash/new "SHA-256") (hex-decode INPUT)))))
#+end_src

#+RESULTS:
: 9F64A747E1B97F131FABB6B447296C9B6F0201E79FB3C5356E6C77E89B6A806A

** Plain text repeat
#+HEADER: :var REPEAT_COUNT = 10
#+HEADER: :var TEXT = "abcd"
#+begin_src janet
  (use botan)
  (let [hash (hash/new "SHA-256")]
    (for i 0 REPEAT_COUNT (:update hash TEXT))
    (print (hex-encode (:final hash))))
#+end_src

#+RESULTS:
: 38986FC4DEFA1CD49321AD652FF3A02A36EBE62E5EE62C0696AC8F86F76DFA36

** Hex repeat
#+HEADER: :var REPEAT_COUNT = 10
#+HEADER: :var INPUT = "01020304"
#+begin_src janet
    (use botan)
    (let [hash (hash/new "SHA-256")]
      (for i 0 REPEAT_COUNT (:update hash (hex-decode INPUT)))
      (print (hex-encode (:final hash))))
#+end_src

#+RESULTS:
: C7C31ED6686BB62C7981C0FFC16759F7E60FB95231C847964D2674A4D269FE72

* MAC
** HMAC-256 hex input
#+HEADER: :var KEY = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var MSG = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [hmac (mac/new "HMAC(SHA-256)")]
    (:update (:set-key hmac (hex-decode KEY)) (hex-decode MSG))
    (print (hex-encode (:final hmac))))
#+end_src

#+RESULTS:
: B7FB0BE696FEAEC6F647F2F2A7B887944CF39546B1422105FB7FBEBC65787550

** HMAC-256 text input
#+HEADER: :var KEY = "test"
#+HEADER: :var MSG = "more and more data goes into a file to exceed the buffer size"
#+begin_src janet
  (use botan)
  (let [hmac (mac/new "HMAC(SHA-256)")]
    (:update (:set-key hmac KEY) MSG)
    (print (hex-encode (:final hmac))))
#+end_src

#+RESULTS:
: 46B75292B81002FD873E89C532A1B8545D6EFC9822EE938FEBA6DE2723161A67

** HMAC-512 hex input
#+HEADER: :var KEY = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var MSG = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [hmac (mac/new "HMAC(SHA-512)")]
    (:update (:set-key hmac (hex-decode KEY)) (hex-decode MSG))
    (print (hex-encode (:final hmac))))
#+end_src

#+RESULTS:
: 8A122F1E030909B37DEF5193AD119F08B9EF0E0BCE48037574EA26F786F4D9C45DA76B7F769B278053A932930372EDDBF10AB21C2A33FADC997250445D6BD71A

** HMAC-512 text input
#+HEADER: :var KEY = "test"
#+HEADER: :var MSG = "more and more data goes into a file to exceed the buffer size"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "HMAC(SHA-512)")]
    (:update (:set-key mac KEY) MSG)
    (print (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: 5B2B459E89ECD204BEB959DC6214A4C4B7DA20BFC4C8ADACF9615BDDD0B2B8D2E950409E4703DE11F02E50852EDFB3CFBDAF8795E0EBF0AD50CF15E29150D234

** AES-128 CMAC
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var DATA = "000102030405060708090A0B0C0D0E0F"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "CMAC(AES-128)")]
    (:update (:set-key mac (hex-decode KEY)) (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: 7BCFBBCA7A2EA68B966FC5399F74809E

#+end_src
** AES-128 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(AES-128)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: 0474FA92425A16FA4404824A00398C74

#+end_src
** AES-192 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(AES-192)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: FE47D853E827FCA47BB5E87D0F6423B8

#+end_src
** AES-256 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(AES-256)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: 65DC9D99AB0FF0F31351A169DC0EC101

#+end_src
** ARIA-128 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(ARIA-128)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: 62B01592621FEACB86CCCC541CC9D169

#+end_src
** ARIA-192 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(ARIA-192)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: F0B6264439A0EBDD043ECFDED8A268E8

#+end_src
** ARIA-256 GMAC
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var DATA  = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [mac (mac/new "GMAC(ARIA-256)")]
    (:set-key mac (hex-decode KEY))
    (:set-nonce mac (hex-decode NONCE))
    (:update mac (hex-decode DATA))
    (print "TAG: " (hex-encode (:final mac))))
#+end_src

#+RESULTS:
: TAG: E0DED6F693CEEFAE2C10DF84EDE5BC15

#+end_src

* AES
** AES-128
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-128")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 69C4E0D86A7B0430D8CDB78070B4C55A

*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "69C4E0D86A7B0430D8CDB78070B4C55A"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-128")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF

** AES-192
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-192")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 65D50128B115A7780981475A6BD64A0E

*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var ENCRYPTED = "65D50128B115A7780981475A6BD64A0E"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-192")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF

** AES-256
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-256")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 8EA2B7CA516745BFEAFC49904B496089
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F"
#+HEADER: :var ENCRYPTED = "8EA2B7CA516745BFEAFC49904B496089"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "AES-256")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF
** AES-GCM-128
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: 565680A8B07A8E5AFE067D91B9168154
: Tag: 343EF77F1C6DE85BB313B51E9AAD2291
*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "565680A8B07A8E5AFE067D91B9168154"
#+HEADER: :var INPUT_TAG = "343EF77F1C6DE85BB313B51E9AAD2291"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-GCM-192
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF0011223344556677"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-192/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: 545DD08DF08C14CA7100400B4A3833DD
: Tag: 94F0FA724CA153D25C5F95A007FC9BD6

*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF0011223344556677"
#+HEADER: :var ENCRYPTED = "545DD08DF08C14CA7100400B4A3833DD"
#+HEADER: :var INPUT_TAG = "94F0FA724CA153D25C5F95A007FC9BD6"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-192/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-GCM-256
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: D9AB5267E66C88BA53BD3EB1D877E958
: Tag: C7FE61A04359304E950A454644C12C88

*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "D9AB5267E66C88BA53BD3EB1D877E958"
#+HEADER: :var INPUT_TAG = "C7FE61A04359304E950A454644C12C88"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
*** Encrypt text string
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "string text input"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc TEXT)))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: BAFF104ED86BD84EA665FA5161F9692DA4
: Tag: 5E11C2B9BBFBD7D4B4B84BDCF0DDB280

*** Decrypt to text string
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "BAFF104ED86BD84EA665FA5161F9692DA4"
#+HEADER: :var INPUT_TAG = "5E11C2B9BBFBD7D4B4B84BDCF0DDB280"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG)))))
#+end_src

#+RESULTS:
: string text input
** AES-CBC-128 NoPadding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/NoPadding" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: A28F5667E6CE191444647F5B2E570AE8
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var ENCRYPTED = "A28F5667E6CE191444647F5B2E570AE8"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/NoPadding" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-CBC-128 PKCS7 Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/PKCS7" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: A28F5667E6CE191444647F5B2E570AE8644F7CE15636077CFB9ADD5CD87FC6C6
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "A28F5667E6CE191444647F5B2E570AE8644F7CE15636077CFB9ADD5CD87FC6C6"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/PKCS7" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-CBC-128 OneAndZeros Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/OneAndZeros" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: A28F5667E6CE191444647F5B2E570AE8726BB1394D7F883A0A298EE1D9510E64
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "A28F5667E6CE191444647F5B2E570AE8726BB1394D7F883A0A298EE1D9510E64"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CBC/OneAndZeros" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-CBC-256 PKCS7 Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/CBC/PKCS7" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 19F01F6269952794B3714810E26BE3D5E6267DFE058BF54D4E377CBD3E434FD4
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "19F01F6269952794B3714810E26BE3D5E6267DFE058BF54D4E377CBD3E434FD4"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/CBC/PKCS7" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** AES-CBC-256 OneAndZeros Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "112233445566665544332211"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/CBC/OneAndZeros" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 7B1803081258477C997943AE6EDD290C
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "7B1803081258477C997943AE6EDD290C"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-256/CBC/OneAndZeros" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 112233445566665544332211
** AES-CTR-128
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CTR" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 0DBFDF84A3810CE19DD7394598DE505F1E0ED42DFBBD7EB164BE5DA7F5CD5C23
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var ENCRYPTED = "0DBFDF84A3810CE19DD7394598DE505F1E0ED42DFBBD7EB164BE5DA7F5CD5C23"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CTR" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F
** AES-CCM-128
*** Encrypt
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT  = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var AAD   = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode NONCE))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: 326AD41E63D474A45618919268C45AF2
: Tag: FF60D3CC73E4E6EF95BBB13616C3AE27
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "326AD41E63D474A45618919268C45AF2"
#+HEADER: :var INPUT_TAG = "FF60D3CC73E4E6EF95BBB13616C3AE27"
#+HEADER: :var NONCE     = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "AES-128/CCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode NONCE))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000

* NIST AES key wrapper (RFC3394)
** Wrap
#+HEADER: :var KEK = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var KEY = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (print (hex-encode (nist-key-wrap (hex-decode KEK) (hex-decode KEY))))
#+end_src

#+RESULTS:
: 1FA68B0A8112B447AEF34BD8FB5A7B829D3E862371D2CFE5
** Unwrap
#+HEADER: :var KEK = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var WRAPPED_KEY = "1FA68B0A8112B447AEF34BD8FB5A7B829D3E862371D2CFE5"
#+begin_src janet
  (use botan)
  (print (hex-encode (nist-key-unwrap (hex-decode KEK) (hex-decode WRAPPED_KEY))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF

* ARIA
** ARIA-128
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-128")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: D718FBD6AB644C739DA95F3BE6451778

*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "D718FBD6AB644C739DA95F3BE6451778"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-128")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF

** ARIA-192
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-192")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 0DEDEC2A613869147C86397A97CA44F6

*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F0001020304050607"
#+HEADER: :var ENCRYPTED = "0DEDEC2A613869147C86397A97CA44F6"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-192")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF

** ARIA-256
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F"
#+HEADER: :var TEXT = "00112233445566778899AABBCCDDEEFF"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-256")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: F92BD7C79FB72E2F2B8F80C1972D24FC
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F"
#+HEADER: :var ENCRYPTED = "F92BD7C79FB72E2F2B8F80C1972D24FC"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "ARIA-256")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 00112233445566778899AABBCCDDEEFF
** ARIA-GCM-128
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: B2949DD080ADFFA66C72BE18A3817CF3
: Tag: B7DFC8E22C8C3212AD7ACED059966E7A
*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "B2949DD080ADFFA66C72BE18A3817CF3"
#+HEADER: :var INPUT_TAG = "B7DFC8E22C8C3212AD7ACED059966E7A"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-GCM-192
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF0011223344556677"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-192/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: E203BFFE67525F15E258F465418F9378
: Tag: 7AEBC287AE39724DB396BE4105808CD4

*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF0011223344556677"
#+HEADER: :var ENCRYPTED = "E203BFFE67525F15E258F465418F9378"
#+HEADER: :var INPUT_TAG = "7AEBC287AE39724DB396BE4105808CD4"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-192/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-GCM-256
*** Encrypt
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: 5FD6F4743CC128D4692E467AC7082F48
: Tag: 4A85EA53925DA74964CE1BE7F38A3840

*** Decrypt
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "5FD6F4743CC128D4692E467AC7082F48"
#+HEADER: :var INPUT_TAG = "4A85EA53925DA74964CE1BE7F38A3840"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
*** Encrypt text string
#+HEADER: :var KEY  = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var TEXT = "string text input"
#+HEADER: :var IV   = "112233445566778899AABBCC"
#+HEADER: :var AAD  = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/GCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (def ret (hex-encode (:finish sc TEXT)))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: 3C82B65D02C678209CF6829A7E86AF3D17
: Tag: A75370B9E717F73875F02E4491FB022D

*** Decrypt to text string
#+HEADER: :var KEY       = "00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF"
#+HEADER: :var ENCRYPTED = "3C82B65D02C678209CF6829A7E86AF3D17"
#+HEADER: :var INPUT_TAG = "A75370B9E717F73875F02E4491FB022D"
#+HEADER: :var IV        = "112233445566778899AABBCC"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/GCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode IV))
    (print (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG)))))
#+end_src

#+RESULTS:
: string text input
** ARIA-CBC-128 NoPadding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/NoPadding" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 63792CEE6F18F62170822C347775F71D
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var ENCRYPTED = "63792CEE6F18F62170822C347775F71D"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/NoPadding" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-CBC-128 PKCS7 Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/PKCS7" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 63792CEE6F18F62170822C347775F71D31D9563961808005B878F605CB708BC5
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "63792CEE6F18F62170822C347775F71D31D9563961808005B878F605CB708BC5"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/PKCS7" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-CBC-128 OneAndZeros Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/OneAndZeros" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 63792CEE6F18F62170822C347775F71D7087D01EA5677EEAF8FA23720BDB91AB
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "63792CEE6F18F62170822C347775F71D7087D01EA5677EEAF8FA23720BDB91AB"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CBC/OneAndZeros" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-CBC-256 PKCS7 Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/CBC/PKCS7" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: EE7BF3D64A28A69B6376C8281FE411708592C33960629AF398F16B854B50E8DA
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "EE7BF3D64A28A69B6376C8281FE411708592C33960629AF398F16B854B50E8DA"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/CBC/PKCS7" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000
** ARIA-CBC-256 OneAndZeros Padding
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT = "112233445566665544332211"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/CBC/OneAndZeros" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: E893C170CFF6E847CFC1DA42925169A7
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "E893C170CFF6E847CFC1DA42925169A7"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-256/CBC/OneAndZeros" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 112233445566665544332211
** ARIA-CTR-128
*** Encrypt
#+HEADER: :var KEY  = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV   = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var TEXT = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CTR" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: EFFC474AE70949DA46BF4F713207ECA663E24C8E569ECC950E7B3C550F44F60A
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var IV        = "112233445566778899AABBCCDDEEFF00"
#+HEADER: :var ENCRYPTED = "EFFC474AE70949DA46BF4F713207ECA663E24C8E569ECC950E7B3C550F44F60A"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CTR" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F
** ARIA-CCM-128
*** Encrypt
#+HEADER: :var KEY   = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var TEXT  = "102030405060708090A0B0C0D0E0F000"
#+HEADER: :var NONCE = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var AAD   = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CCM" :encrypt)
       tag-len (:get-tag-length sc)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode NONCE))
    (def ret (hex-encode (:finish sc (hex-decode TEXT))))
    (print "Enc: " (string/slice ret 0 (- (length ret) (* 2 tag-len))))
    (print "Tag: " (string/slice ret (- (length ret) (* 2 tag-len)))))
#+end_src

#+RESULTS:
: Enc: A093B40F96657DFC7B2DE4DC1E7A70B9
: Tag: 25895A5116F0A697D619D59E29DEDD36
*** Decrypt
#+HEADER: :var KEY       = "000102030405060708090A0B0C0D0E0F"
#+HEADER: :var ENCRYPTED = "A093B40F96657DFC7B2DE4DC1E7A70B9"
#+HEADER: :var INPUT_TAG = "25895A5116F0A697D619D59E29DEDD36"
#+HEADER: :var NONCE     = "FFFFFFFFFFFFFFFFFFFFFFFF"
#+HEADER: :var AAD       = "0102030405060708090A0B0C0D0E"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "ARIA-128/CCM" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:set-associated-data sc (hex-decode AAD))
    (:start sc (hex-decode NONCE))
    (print (hex-encode (:finish sc (hex-decode (string ENCRYPTED INPUT_TAG))))))
#+end_src

#+RESULTS:
: 102030405060708090A0B0C0D0E0F000

* DES
** DES
*** Encrypt
#+HEADER: :var KEY  = "0001020304050607"
#+HEADER: :var TEXT = "0011223344556677"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "DES")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:encrypt bc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 3EF0A891CF8ED990

*** Decrypt
#+HEADER: :var KEY       = "0001020304050607"
#+HEADER: :var ENCRYPTED = "3EF0A891CF8ED990"
#+begin_src janet
  (use botan)
  (let [bc (block-cipher/new "DES")]
    (:set-key bc (hex-decode KEY))
    (print (hex-encode (:decrypt bc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 0011223344556677

** DES-CBC NoPadding
*** Encrypt
#+HEADER: :var KEY  = "0001020304050607"
#+HEADER: :var IV   = "1122334455667788"
#+HEADER: :var TEXT = "1020304050607080"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/NoPadding" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 6ACC204F8EFBCCC7
*** Decrypt
#+HEADER: :var KEY       = "0001020304050607"
#+HEADER: :var IV        = "1122334455667788"
#+HEADER: :var ENCRYPTED = "6ACC204F8EFBCCC7"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/NoPadding" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 1020304050607080
** DES-CBC PKCS7 Padding
*** Encrypt
#+HEADER: :var KEY  = "0001020304050607"
#+HEADER: :var IV   = "1122334455667788"
#+HEADER: :var TEXT = "1020304050607080"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/PKCS7" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 6ACC204F8EFBCCC7C80EE4F58CA1A2E5
*** Decrypt
#+HEADER: :var KEY       = "0001020304050607"
#+HEADER: :var IV        = "1122334455667788"
#+HEADER: :var ENCRYPTED = "6ACC204F8EFBCCC7C80EE4F58CA1A2E5"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/PKCS7" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 1020304050607080
** DES-CBC OneAndZeros Padding
*** Encrypt
#+HEADER: :var KEY  = "0001020304050607"
#+HEADER: :var IV   = "1122334455667788"
#+HEADER: :var TEXT = "1020304050607080"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/OneAndZeros" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: 6ACC204F8EFBCCC7FD7B57744B67C0A9
*** Decrypt
#+HEADER: :var KEY       = "0001020304050607"
#+HEADER: :var IV        = "1122334455667788"
#+HEADER: :var ENCRYPTED = "6ACC204F8EFBCCC7FD7B57744B67C0A9"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CBC/OneAndZeros" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 1020304050607080
** DES-CTR
*** Encrypt
#+HEADER: :var KEY  = "0001020304050607"
#+HEADER: :var IV   = "1122334455667788"
#+HEADER: :var TEXT = "1020304050607080"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CTR" :encrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode TEXT)))))
#+end_src

#+RESULTS:
: DC958B81223682A7
*** Decrypt
#+HEADER: :var KEY       = "0001020304050607"
#+HEADER: :var IV        = "1122334455667788"
#+HEADER: :var ENCRYPTED = "DC958B81223682A7"
#+begin_src janet
  (use botan)
  (let [sc (cipher/new "DES/CTR" :decrypt)]
    (:set-key sc (hex-decode KEY))
    (:start sc (hex-decode IV))
    (print (hex-encode (:finish sc (hex-decode ENCRYPTED)))))
#+end_src

#+RESULTS:
: 1020304050607080

* ECDH
** Random key - Create sessionkey
#+HEADER: :var TEXT        = "test msg"
#+begin_src janet
  (use botan)
  (let [prikey1 (privkey/new "ECDH" "secp256r1")
        prikey2 (privkey/new "ECDH" "secp256r1")
        pubkey1 (:get-pubkey prikey1)
        pubkey2 (:get-pubkey prikey2)
        prikey1-val (:to-bin (:get-field prikey1 "x"))
        prikey2-val (:to-bin (:get-field prikey2 "x"))
        pubkey1-val (:get-public-point pubkey1)
        pubkey2-val (:get-public-point pubkey2)
        pk-ka1 (pk-key-agreement/new prikey1 "KDF2(SHA-256)")
        pk-ka2 (pk-key-agreement/new prikey2 "KDF2(SHA-256)")
        salt (:get (rng/new) 64)
        agreekey1 (:agree pk-ka1 pubkey2-val salt)
        agreekey2 (:agree pk-ka2 pubkey1-val salt)
       ]
    (print "prikeyA: " (hex-encode prikey1-val))
    (print "prikeyB: " (hex-encode prikey2-val))
    (print "pubkeyA: " (hex-encode pubkey1-val))
    (print "pubkeyB: " (hex-encode pubkey2-val))
    (print "agreekeyA: " (hex-encode agreekey1))
    (print "agreekeyB: " (hex-encode agreekey2)))
#+end_src

#+RESULTS:
: prikeyA: 3ED35510A13ACD3898739A734FDDF004164A5926958744BB3C0922F90C87DEAC
: prikeyB: E79314FC2CE53087E0FE9220F3BB4FB69ED62CF9C737EE726ECD3F4BDC824971
: pubkeyA: 04B7753571D532C46E4B52DFB4DD6162434AB48BCA194A5B1428270071D8F329FC6FAB4B19880A950D499F36131BE34A35CC7BF993D78E36F7184FB66DAFD0E57A
: pubkeyB: 049520530DC2D9271EE29359B3AAFA632F75334D867A5F2ADEE445C518F5B8608721034917AF16FF228D2C351F5021BB67C5530DBFAD2E312A5C1BCDDDBA42A4B1
: agreekeyA: 8C9CFF975CF2C2F24EBF36B34CA31EFE3BFAFBB21D650B3560CAE2C0D16512BB
: agreekeyB: 8C9CFF975CF2C2F24EBF36B34CA31EFE3BFAFBB21D650B3560CAE2C0D16512BB

** Existing key(Hex) - Create sessionkey (Public key can be omitted)
#+HEADER: :var A_PRIVATE_KEY = "272381629D174EAD2F3939F2FFDCFCFDAFB5885E789EBA30969127F6B6E8F8E2"
#+HEADER: :var A_PUBLIC_KEY  = "048D05F3D3FC92A06F97B3D6861D0C9425483E16E2F6AA2729F99211FF1B364E10A46B47A96EF995785245FC5302EF45A0D5EF1486B9865603969118D455AFBB53"
#+HEADER: :var B_PRIVATE_KEY = "EBF6E5A05A4AC0D1D2B2A629BF808B50B51DB7ED5E7CBAE968783C925FCC679D"
#+HEADER: :var B_PUBLIC_KEY  = "04EFB6C4A48C69D85C6831922530536FE4500D16F90A454960465CDBF178E4728373D41625F3906A69107463FDD0FA03A1C4E1EB619968DEFEB41D1338B65049D4"
#+begin_src janet
  (use botan)
  (let [prikey1-mpi (mpi/from-hex-str A_PRIVATE_KEY)
        prikey2-mpi (mpi/from-hex-str B_PRIVATE_KEY)

        pubkey1-mpi-x (mpi/from-hex-str (string/slice A_PUBLIC_KEY 2 (+ 2 (/ (- (length A_PUBLIC_KEY) 2) 2))))
        pubkey1-mpi-y (mpi/from-hex-str (string/slice A_PUBLIC_KEY (+ 2 (/ (- (length A_PUBLIC_KEY) 2) 2))))

        pubkey2-mpi-x (mpi/from-hex-str (string/slice B_PUBLIC_KEY 2 (+ 2 (/ (- (length B_PUBLIC_KEY) 2) 2))))
        pubkey2-mpi-y (mpi/from-hex-str (string/slice B_PUBLIC_KEY (+ 2 (/ (- (length B_PUBLIC_KEY) 2) 2))))

        prikey1 (privkey/load-ecdh "secp256r1" prikey1-mpi)
        prikey2 (privkey/load-ecdh "secp256r1" prikey2-mpi)

        pubkey1 (pubkey/load-ecdh "secp256r1" pubkey1-mpi-x pubkey1-mpi-y)
        pubkey2 (pubkey/load-ecdh "secp256r1" pubkey2-mpi-x pubkey2-mpi-y)

        pubkey1-from-pri (:get-pubkey prikey1)
        pubkey2-from-pri (:get-pubkey prikey2)

        pk-ka (pk-key-agreement/new prikey1 "Raw")
        agreekey (:agree pk-ka (:get-public-point pubkey2) "")]
    (assert (= (:get-public-point pubkey1) (:get-public-point pubkey1-from-pri)))
    (assert (= (:get-public-point pubkey2) (:get-public-point pubkey2-from-pri)))

    (print "prikeyA: " (hex-encode (:to-bin prikey1-mpi)))
    (print "prikeyB: " (hex-encode (:to-bin prikey2-mpi)))
    (print "pubkeyA: " (hex-encode (:get-public-point pubkey1)))
    (print "pubkeyB: " (hex-encode (:get-public-point pubkey2)))
    (print "agreekey: " (hex-encode agreekey)))
#+end_src

#+RESULTS:
: prikeyA: 272381629D174EAD2F3939F2FFDCFCFDAFB5885E789EBA30969127F6B6E8F8E2
: prikeyB: EBF6E5A05A4AC0D1D2B2A629BF808B50B51DB7ED5E7CBAE968783C925FCC679D
: pubkeyA: 048D05F3D3FC92A06F97B3D6861D0C9425483E16E2F6AA2729F99211FF1B364E10A46B47A96EF995785245FC5302EF45A0D5EF1486B9865603969118D455AFBB53
: pubkeyB: 04EFB6C4A48C69D85C6831922530536FE4500D16F90A454960465CDBF178E4728373D41625F3906A69107463FDD0FA03A1C4E1EB619968DEFEB41D1338B65049D4
: agreekey: 3C027AF77D256133E465CE56ABC1CF31B3D428FD5FE528A4481BCF5D295DAA69

** Existing key(Big Int) - Create sessionkey
#+HEADER: :var A_PRIVATE_KEY = "17702933725911759833018382133741290876335542967772335450363342488878254192866"
#+HEADER: :var A_PUBLIC_KEY  = "61017218725251769835925365666700278871445386965526678184487919969123210546842177730340048341794298839866705223449066751284256420111064842794150013009115987"
#+HEADER: :var B_PRIVATE_KEY = "106729748618016823529684004271423234939788438170848142794308826289302701631389"
#+HEADER: :var B_PUBLIC_KEY  = "66186069373064324507716733592744495348638623787425372736469519431587026981344737339468148830286137966427921162803027707669848205986009555327089307961805268"
#+begin_src janet
  (use botan)
  (let [prikey1-hex (hex-encode (:to-bin (mpi/from-str A_PRIVATE_KEY)))
        prikey2-hex (hex-encode (:to-bin (mpi/from-str B_PRIVATE_KEY)))
        pubkey1-hex (hex-encode (:to-bin (mpi/from-str A_PUBLIC_KEY)))
        pubkey2-hex (hex-encode (:to-bin (mpi/from-str B_PUBLIC_KEY)))

        prikey1-mpi (mpi/from-str A_PRIVATE_KEY)
        prikey2-mpi (mpi/from-str B_PRIVATE_KEY)

        pubkey1-mpi-x (mpi/from-hex-str (string/slice pubkey1-hex 2 (+ 2 (/ (- (length pubkey1-hex) 2) 2))))
        pubkey1-mpi-y (mpi/from-hex-str (string/slice pubkey1-hex (+ 2 (/ (- (length pubkey1-hex) 2) 2))))

        pubkey2-mpi-x (mpi/from-hex-str (string/slice pubkey2-hex 2 (+ 2 (/ (- (length pubkey2-hex) 2) 2))))
        pubkey2-mpi-y (mpi/from-hex-str (string/slice pubkey2-hex (+ 2 (/ (- (length pubkey2-hex) 2) 2))))

        prikey1 (privkey/load-ecdh "secp256r1" prikey1-mpi)
        prikey2 (privkey/load-ecdh "secp256r1" prikey2-mpi)

        pubkey1 (pubkey/load-ecdh "secp256r1" pubkey1-mpi-x pubkey1-mpi-y)
        pubkey2 (pubkey/load-ecdh "secp256r1" pubkey2-mpi-x pubkey2-mpi-y)

        pubkey1-from-pri (:get-pubkey prikey1)
        pubkey2-from-pri (:get-pubkey prikey2)

        pk-ka (pk-key-agreement/new prikey1 "Raw")
        agreekey (:agree pk-ka (:get-public-point pubkey2) "")]
    (assert (= (:get-public-point pubkey1) (:get-public-point pubkey1-from-pri)))
    (assert (= (:get-public-point pubkey2) (:get-public-point pubkey2-from-pri)))

    (print "prikeyA: " (hex-encode (:to-bin prikey1-mpi)))
    (print "prikeyB: " (hex-encode (:to-bin prikey2-mpi)))
    (print "pubkeyA: " (hex-encode (:get-public-point pubkey1)))
    (print "pubkeyB: " (hex-encode (:get-public-point pubkey2)))
    (print "agreekey: " (hex-encode agreekey)))
#+end_src

#+RESULTS:
: prikeyA: 272381629D174EAD2F3939F2FFDCFCFDAFB5885E789EBA30969127F6B6E8F8E2
: prikeyB: EBF6E5A05A4AC0D1D2B2A629BF808B50B51DB7ED5E7CBAE968783C925FCC679D
: pubkeyA: 048D05F3D3FC92A06F97B3D6861D0C9425483E16E2F6AA2729F99211FF1B364E10A46B47A96EF995785245FC5302EF45A0D5EF1486B9865603969118D455AFBB53
: pubkeyB: 04EFB6C4A48C69D85C6831922530536FE4500D16F90A454960465CDBF178E4728373D41625F3906A69107463FDD0FA03A1C4E1EB619968DEFEB41D1338B65049D4
: agreekey: 3C027AF77D256133E465CE56ABC1CF31B3D428FD5FE528A4481BCF5D295DAA69

** Existing key(Hex) - Create sessionkey with PriKey A, PubKey B
#+HEADER: :var A_PRIVATE_KEY = "272381629D174EAD2F3939F2FFDCFCFDAFB5885E789EBA30969127F6B6E8F8E2"
#+HEADER: :var B_PUBLIC_KEY  = "04EFB6C4A48C69D85C6831922530536FE4500D16F90A454960465CDBF178E4728373D41625F3906A69107463FDD0FA03A1C4E1EB619968DEFEB41D1338B65049D4"
#+begin_src janet
  (use botan)
  (let [prikey1-mpi (mpi/from-hex-str A_PRIVATE_KEY)

        pubkey2-mpi-x (mpi/from-hex-str (string/slice B_PUBLIC_KEY 2 (+ 2 (/ (- (length B_PUBLIC_KEY) 2) 2))))
        pubkey2-mpi-y (mpi/from-hex-str (string/slice B_PUBLIC_KEY (+ 2 (/ (- (length B_PUBLIC_KEY) 2) 2))))

        prikey1 (privkey/load-ecdh "secp256r1" prikey1-mpi)
        pubkey2 (pubkey/load-ecdh "secp256r1" pubkey2-mpi-x pubkey2-mpi-y)

        pk-ka (pk-key-agreement/new prikey1 "Raw")
        agreekey (:agree pk-ka (:get-public-point pubkey2) "")]
    (print "prikeyA: " (hex-encode (:to-bin prikey1-mpi)))
    (print "pubkeyB: " (hex-encode (:get-public-point pubkey2)))
    (print "agreekey: " (hex-encode agreekey)))
#+end_src

#+RESULTS:
: prikeyA: 272381629D174EAD2F3939F2FFDCFCFDAFB5885E789EBA30969127F6B6E8F8E2
: pubkeyB: 04EFB6C4A48C69D85C6831922530536FE4500D16F90A454960465CDBF178E4728373D41625F3906A69107463FDD0FA03A1C4E1EB619968DEFEB41D1338B65049D4
: agreekey: 3C027AF77D256133E465CE56ABC1CF31B3D428FD5FE528A4481BCF5D295DAA69

* ECDSA
** Random key - Create signature - TEXT input
#+HEADER: :var TEXT        = "test msg"
#+begin_src janet
  (use botan)
  (let [prikey1 (privkey/new "ECDSA" "secp256r1")
        prikey2 (privkey/new "ECDSA" "secp256r1")

        pubkey1 (:get-pubkey prikey1)
        pubkey2 (:get-pubkey prikey2)

        pk-sig (pk-sign/new prikey1 "EMSA1(SHA-256)")
        pk-veri (pk-verify/new pubkey1 "EMSA1(SHA-256)")

        text TEXT
        signature (:finish (:update pk-sig text))
        sig-verify (:finish (:update pk-veri text) signature)]
    (print "prikeyA:   " (hex-encode (:to-bin (:get-field prikey1 "x"))))
    (print "prikeyB:   " (hex-encode (:to-bin (:get-field prikey2 "x"))))
    (print "pubkeyA:   " (hex-encode (:get-public-point pubkey1)))
    (print "pubkeyB:   " (hex-encode (:get-public-point pubkey2)))
    (print "input:     " text)
    (print "signature: " (hex-encode signature))
    (print "valid?:    " sig-verify))
#+end_src

#+RESULTS:
: prikeyA:   5A6368F2E494684A0584CDAB69BE2A645E5BD4B8970659133542D8DE067C1E7D
: prikeyB:   F5188B139959983096532DBB1476CCAA6E943CA48E36D6CFFD760F877FC17CAE
: pubkeyA:   04801263EF71289EDEFFDD7F877880DAFABB0D09FE1E38332D24C82DF7DD548035087CD15504CA51F4A4C9B988F931CB21BF8EE11103C2A8887C4F0C8D68F450B0
: pubkeyB:   044CB7C7468D2694E674FD9E4CE652EC52036E301A69F6A3CC870DA5FC254CDF53AB3B4B115D7DD5466CF19718E6DC7F3820F4B74B0B882FA88EDF41508546A095
: input:     test msg
: signature: C21446240F1C3D1787DE82EF775BFFCF07787A48CBB1A9A2F9F47794DA401ED7E9D7970D9426D678D3BCD105727CC98E992960F3D757ABEA32EDD59C367EC2B0
: valid?:    true

** Random key - Create signature - HEX input
#+HEADER: :var TEXT        = "010203040506"
#+begin_src janet
  (use botan)
  (let [prikey1 (privkey/new "ECDSA" "secp256r1")
        prikey2 (privkey/new "ECDSA" "secp256r1")

        pubkey1 (:get-pubkey prikey1)
        pubkey2 (:get-pubkey prikey2)

        pk-sig (pk-sign/new prikey1 "EMSA1(SHA-256)")
        pk-veri (pk-verify/new pubkey1 "EMSA1(SHA-256)")

        text (hex-decode TEXT)
        signature (:finish (:update pk-sig text))
        sig-verify (:finish (:update pk-veri text) signature)]
    (print "prikeyA:   " (hex-encode (:to-bin (:get-field prikey1 "x"))))
    (print "prikeyB:   " (hex-encode (:to-bin (:get-field prikey2 "x"))))
    (print "pubkeyA:   " (hex-encode (:get-public-point pubkey1)))
    (print "pubkeyB:   " (hex-encode (:get-public-point pubkey2)))
    (print "input:     " (hex-encode text))
    (print "signature: " (hex-encode signature))
    (print "valid?:    " sig-verify))
#+end_src

#+RESULTS:
: prikeyA:   4D1EC699AC8FBBFBCC66ED605960D2E199790B27A349AEB35A7B12C9E21F876D
: prikeyB:   E0B66F5E8FEC085594141E46A87A2693C7C9598C7CD071FC3FA831008BADECE2
: pubkeyA:   04991927F93160BAF682E32DC872A70E371F48C33E84FB3E79AFE4BBDDCC3F15377B30DB3FFCC6BB2B81A8A3F637B8049DCA401B2464936E72D4CDA2EC7A6AD48E
: pubkeyB:   046CAFA017C5976539DB6F863C57C0A23275F3D0E7D01C25AE5715BBDB7B463D678ECBB7D6A72F9EBD90A725B14468C14AFA1CA2108FB00C712D3A73C869C3EC24
: input:     010203040506
: signature: 85DF4B783B495D2FB30D46FF48B9545908C8DADA0FF0E8758C5018DD2F2794E54A0AFD14C0352F3140D945366D884404165B4939EF86F1DF385926FB73305367
: valid?:    true

** Existing key - Create signature TEXT input
#+HEADER: :var TEXT        = "test msg"
#+HEADER: :var PRIVATE_KEY = "DBC868EF66949314FC040180FC6F1A9867466028364140361FF770733B23EF76"
#+begin_src janet
  (use botan)
  (let [prikey1 (privkey/load-ecdsa "secp256r1" (mpi/from-hex-str PRIVATE_KEY))

        pk-sig (pk-sign/new prikey1 "EMSA1(SHA-256)")

        text TEXT
        signature (:finish (:update pk-sig text))]
    (print "prikey:    " (hex-encode (:to-bin (:get-field prikey1 "x"))))
    (print "input:     " (hex-encode text))
    (print "signature: " (hex-encode signature)))
#+end_src

#+RESULTS:
: prikey:    DBC868EF66949314FC040180FC6F1A9867466028364140361FF770733B23EF76
: input:     74657374206D7367
: signature: BE5F8ACA879F2AA8D2385134AAD44792EAF84CE997A8C4328608BE75447999DB7934DB668DFE49DD4E5CCF7F13CDB304D148B510A4FBA6F3D8B00DAD97FB806E

** Existing key - Create signature HEX input
#+HEADER: :var TEXT        = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var PRIVATE_KEY = "DBC868EF66949314FC040180FC6F1A9867466028364140361FF770733B23EF76"
#+begin_src janet
  (use botan)
  (let [prikey1 (privkey/load-ecdsa "secp256r1" (mpi/from-hex-str PRIVATE_KEY))

        pk-sig (pk-sign/new prikey1 "EMSA1(SHA-256)")

        text (hex-decode TEXT)
        signature (:finish (:update pk-sig text))]
    (print "prikey:    " (hex-encode (:to-bin (:get-field prikey1 "x"))))
    (print "input:     " (hex-encode text))
    (print "signature: " (hex-encode signature)))
#+end_src

#+RESULTS:
: prikey:    DBC868EF66949314FC040180FC6F1A9867466028364140361FF770733B23EF76
: input:     000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F
: signature: 77A75FD1894F4113B5904CE6FBB8819B658856266FFCE3417C799C8E9163D87865CC4D12F3504181C53BAE8C1D497764E47080B73C72764D5F6E717C48E08896

** Existing key - Signature check - TEXT input
#+HEADER: :var TEXT        = "test msg"
#+HEADER: :var PUBLIC_KEY  = "04A9A712C7B56F3C878F230C6F6F31564D11D29F9E30A146E7F99904F6FD743708662C3B989201E6437F9DC261AF500F68C93EF2382F93F9B842E679F5297C1907"
#+HEADER: :var SIGNATURE   = "AC2527E96694CC18BD9A89D1F101CEC292887BC79EE1BD5D9E20CC0E67DFB26C5E486FE5535811368C7D88490399C91D478321A04F05E9C9E265EC1416A41185"
#+begin_src janet
  (use botan)
  (let [pubkey1-mpi-x (mpi/from-hex-str (string/slice PUBLIC_KEY 2 (+ 2 (/ (- (length PUBLIC_KEY) 2) 2))))
        pubkey1-mpi-y (mpi/from-hex-str (string/slice PUBLIC_KEY (+ 2 (/ (- (length PUBLIC_KEY) 2) 2))))

        pubkey1 (pubkey/load-ecdsa "secp256r1" pubkey1-mpi-x pubkey1-mpi-y)

        pk-veri (pk-verify/new pubkey1 "EMSA1(SHA-256)")

        text TEXT
        sig-verify (:finish (:update pk-veri text) (hex-decode SIGNATURE))]
    (print "valid?: " sig-verify))
#+end_src

#+RESULTS:
: valid?: true
** Existing key - Signature check - HEX input
#+HEADER: :var TEXT        = "000102030405060708090A0B0C0D0E0F000102030405060708090A0B0C0D0E0F"
#+HEADER: :var PUBLIC_KEY  = "04A9A712C7B56F3C878F230C6F6F31564D11D29F9E30A146E7F99904F6FD743708662C3B989201E6437F9DC261AF500F68C93EF2382F93F9B842E679F5297C1907"
#+HEADER: :var SIGNATURE   = "999ED1ADF893B7E4812D43AF1205FCAC40B55FAEA44EEAF0B040F4596D7DA0AD3767A2381D288EFB5F2B7684F9A385710653B2C1E094B9C9DEF8A3898F734C78"
#+begin_src janet
  (use botan)
  (let [pubkey1-mpi-x (mpi/from-hex-str (string/slice PUBLIC_KEY 2 (+ 2 (/ (- (length PUBLIC_KEY) 2) 2))))
        pubkey1-mpi-y (mpi/from-hex-str (string/slice PUBLIC_KEY (+ 2 (/ (- (length PUBLIC_KEY) 2) 2))))

        pubkey1 (pubkey/load-ecdsa "secp256r1" pubkey1-mpi-x pubkey1-mpi-y)

        pk-veri (pk-verify/new pubkey1 "EMSA1(SHA-256)")

        text (hex-decode TEXT)
        sig-verify (:finish (:update pk-veri text) (hex-decode SIGNATURE))]
    (print "valid?: " sig-verify))
#+end_src

#+RESULTS:
: valid?: true
